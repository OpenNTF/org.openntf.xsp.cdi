<?xml version="1.0"?>
<project
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
	xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<modelVersion>4.0.0</modelVersion>
	<groupId>org.openntf.xsp</groupId>
	<artifactId>xspcdi-osgi-deps</artifactId>
	<version>1.0.0-SNAPSHOT</version>
	
	<description>
		This project exists to generate a local p2 site for use as part of the OSGi
		target platform during compilation
	</description>
	
	<packaging>pom</packaging>
	
	<repositories>
		<repository>
			<id>eclipse-platform</id>
			<url>http://download.eclipse.org/releases/neon/201612211000</url>
			<layout>p2</layout>
		</repository>
	</repositories>
	
	<build>
		<plugins>
			<plugin>
			    <groupId>org.reficio</groupId>
				<artifactId>p2-maven-plugin</artifactId>
				<version>1.3.0</version>
				<extensions>true</extensions>
				
				<executions>
					<execution>
						<id>generate-p2-site</id>
						<phase>prepare-package</phase>
						<goals>
							<goal>site</goal>
						</goals>
						<configuration>
							<artifacts>
								<artifact><id>org.jboss.weld.se:weld-se-core:3.0.4.Final</id><source>true</source></artifact>
								<artifact><id>org.glassfish.jersey.core:jersey-server:2.27</id><source>true</source></artifact>
								<artifact><id>org.glassfish.jersey.containers:jersey-container-servlet:2.27</id><source>true</source></artifact>
								<artifact><id>org.glassfish.jersey.inject:jersey-hk2:2.27</id><source>true</source></artifact>
								
								<!-- Include log4j to satisfy runtime expectations -->
								<artifact><id>org.apache.logging.log4j:log4j-api:2.11.0</id><source>true</source></artifact>

								<!--
									Override use of Import-Package because Domino's org.eclipse.osgi provides
									javax.annotation but not javax.annotation.Priority
								-->
								<artifact>
									<id>org.jboss.weld.environment:weld-environment-common:3.0.4.Final</id>
									<override>true</override>
									<instructions>
										<Require-Bundle>
											org.jboss.spec.javax.annotation.jboss-annotations-api_1.3_spec
										</Require-Bundle>
										<Import-Package>
											javax.enterprise.context;resolution:=optional,
											javax.enterprise.inject;resolution:=optional,
											javax.enterprise.inject.spi;resolution:=optional,
											javax.inject;resolution:=optional,
											org.jboss.jandex;resolution:=optional,
											org.jboss.logging;resolution:=optional,
											org.jboss.weld;resolution:=optional,
											org.jboss.weld.bootstrap.api;resolution:=optional,
											org.jboss.weld.bootstrap.api.helpers;resolution:=optional,
											org.jboss.weld.bootstrap.spi;resolution:=optional,
											org.jboss.weld.ejb.spi;resolution:=optional,
											org.jboss.weld.environment.deployment;resolution:=optional,
											org.jboss.weld.environment.deployment.discovery;resolution:=optional,
											org.jboss.weld.environment.deployment.discovery.jandex;resolution:=optional,
											org.jboss.weld.environment.logging;resolution:=optional,
											org.jboss.weld.environment.util;resolution:=optional,
											org.jboss.weld.exceptions;resolution:=optional,
											org.jboss.weld.manager;resolution:=optional,
											org.jboss.weld.resources.spi;resolution:=optional,
											org.jboss.weld.security;resolution:=optional,
											org.jboss.weld.util;resolution:=optional,
											org.jboss.weld.util.cache;resolution:=optional,
											org.jboss.weld.util.collections;resolution:=optional,
											org.jboss.weld.xml;resolution:=optional
										</Import-Package>
									</instructions>
								</artifact>
								<artifact>
									<id>org.jboss.weld:weld-core-impl:3.0.4.Final</id>
									<override>true</override>
									<instructions>
										<Require-Bundle>
											org.jboss.spec.javax.annotation.jboss-annotations-api_1.3_spec
										</Require-Bundle>
										<Import-Package>
											javax.decorator;resolution:=optional,
											javax.el;resolution:=optional,
											javax.enterprise.context;resolution:=optional,
											javax.enterprise.context.control;resolution:=optional,
											javax.enterprise.context.spi;resolution:=optional,
											javax.enterprise.event;resolution:=optional,
											javax.enterprise.inject;resolution:=optional,
											javax.enterprise.inject.spi;resolution:=optional,
											javax.enterprise.inject.spi.configurator;resolution:=optional,
											javax.enterprise.util;resolution:=optional,
											javax.inject;resolution:=optional,
											javax.interceptor;resolution:=optional,
											javax.naming;resolution:=optional,
											javax.naming.spi;resolution:=optional,
											javax.xml.namespace;resolution:=optional,
											javax.xml.stream;resolution:=optional,
											javax.xml.stream.events;resolution:=optional,
											javax.xml.transform;resolution:=optional,
											javax.xml.transform.stream;resolution:=optional,
											javax.xml.validation;resolution:=optional,
											org.apache.bcel.classfile;resolution:=optional,
											org.jboss.classfilewriter;resolution:=optional,
											org.jboss.classfilewriter.code;resolution:=optional,
											org.jboss.classfilewriter.util;resolution:=optional,
											org.jboss.logging;resolution:=optional,
											org.jboss.weld;resolution:=optional,
											org.jboss.weld.annotated;resolution:=optional,
											org.jboss.weld.annotated.enhanced;resolution:=optional,
											org.jboss.weld.annotated.enhanced.jlr;resolution:=optional,
											org.jboss.weld.annotated.runtime;resolution:=optional,
											org.jboss.weld.annotated.slim;resolution:=optional,
											org.jboss.weld.annotated.slim.backed;resolution:=optional,
											org.jboss.weld.annotated.slim.unbacked;resolution:=optional,
											org.jboss.weld.bean;resolution:=optional,
											org.jboss.weld.bean.attributes;resolution:=optional,
											org.jboss.weld.bean.builtin;resolution:=optional,
											org.jboss.weld.bean.builtin.ee;resolution:=optional,
											org.jboss.weld.bean.interceptor;resolution:=optional,
											org.jboss.weld.bean.proxy;resolution:=optional,
											org.jboss.weld.bean.proxy.util;resolution:=optional,
											org.jboss.weld.bootstrap;resolution:=optional,
											org.jboss.weld.bootstrap.api;resolution:=optional,
											org.jboss.weld.bootstrap.api.helpers;resolution:=optional,
											org.jboss.weld.bootstrap.enablement;resolution:=optional,
											org.jboss.weld.bootstrap.event;resolution:=optional,
											org.jboss.weld.bootstrap.events;resolution:=optional,
											org.jboss.weld.bootstrap.events.configurator;resolution:=optional,
											org.jboss.weld.bootstrap.spi;resolution:=optional,
											org.jboss.weld.bootstrap.spi.helpers;resolution:=optional,
											org.jboss.weld.config;resolution:=optional,
											org.jboss.weld.configuration.spi;resolution:=optional,
											org.jboss.weld.construction.api;resolution:=optional,
											org.jboss.weld.context;resolution:=optional,
											org.jboss.weld.context.activator;resolution:=optional,
											org.jboss.weld.context.api;resolution:=optional,
											org.jboss.weld.context.bound;resolution:=optional,
											org.jboss.weld.context.unbound;resolution:=optional,
											org.jboss.weld.contexts;resolution:=optional,
											org.jboss.weld.contexts.activator;resolution:=optional,
											org.jboss.weld.contexts.beanstore;resolution:=optional,
											org.jboss.weld.contexts.bound;resolution:=optional,
											org.jboss.weld.contexts.cache;resolution:=optional,
											org.jboss.weld.contexts.conversation;resolution:=optional,
											org.jboss.weld.contexts.unbound;resolution:=optional,
											org.jboss.weld.ejb.spi;resolution:=optional,
											org.jboss.weld.event;resolution:=optional,
											org.jboss.weld.events;resolution:=optional,
											org.jboss.weld.exceptions;resolution:=optional,
											org.jboss.weld.executor;resolution:=optional,
											org.jboss.weld.inject;resolution:=optional,
											org.jboss.weld.injection;resolution:=optional,
											org.jboss.weld.injection.attributes;resolution:=optional,
											org.jboss.weld.injection.producer;resolution:=optional,
											org.jboss.weld.injection.spi;resolution:=optional,
											org.jboss.weld.interceptor;resolution:=optional,
											org.jboss.weld.interceptor.builder;resolution:=optional,
											org.jboss.weld.interceptor.proxy;resolution:=optional,
											org.jboss.weld.interceptor.reader;resolution:=optional,
											org.jboss.weld.interceptor.spi.metadata;resolution:=optional,
											org.jboss.weld.interceptor.spi.model;resolution:=optional,
											org.jboss.weld.interceptor.util;resolution:=optional,
											org.jboss.weld.interceptor.util.proxy;resolution:=optional,
											org.jboss.weld.literal;resolution:=optional,
											org.jboss.weld.logging;resolution:=optional,
											org.jboss.weld.manager;resolution:=optional,
											org.jboss.weld.manager.api;resolution:=optional,
											org.jboss.weld.metadata;resolution:=optional,
											org.jboss.weld.metadata.cache;resolution:=optional,
											org.jboss.weld.module;resolution:=optional,
											org.jboss.weld.persistence;resolution:=optional,
											org.jboss.weld.proxy;resolution:=optional,
											org.jboss.weld.resolution;resolution:=optional,
											org.jboss.weld.resources;resolution:=optional,
											org.jboss.weld.resources.spi;resolution:=optional,
											org.jboss.weld.security;resolution:=optional,
											org.jboss.weld.security.spi;resolution:=optional,
											org.jboss.weld.serialization;resolution:=optional,
											org.jboss.weld.serialization.spi;resolution:=optional,
											org.jboss.weld.serialization.spi.helpers;resolution:=optional,
											org.jboss.weld.servlet.spi;resolution:=optional,
											org.jboss.weld.servlet.spi.helpers;resolution:=optional,
											org.jboss.weld.transaction.spi;resolution:=optional,
											org.jboss.weld.util;resolution:=optional,
											org.jboss.weld.util.annotated;resolution:=optional,
											org.jboss.weld.util.bean;resolution:=optional,
											org.jboss.weld.util.bytecode;resolution:=optional,
											org.jboss.weld.util.cache;resolution:=optional,
											org.jboss.weld.util.collections;resolution:=optional,
											org.jboss.weld.util.reflection;resolution:=optional,
											org.jboss.weld.ws;resolution:=optional,
											org.jboss.weld.xml;resolution:=optional,
											org.xml.sax;resolution:=optional,
											org.xml.sax.helpers;resolution:=optional,
											sun.misc;resolution:=optional,
											sun.reflect;resolution:=optional
										</Import-Package>
									</instructions>
								</artifact>
								
								<!-- Avoid trouble with sun.misc during compilation -->
								<artifact>
									<id>org.jboss.classfilewriter:jboss-classfilewriter:1.2.2.Final</id>
									<override>true</override>
									<instructions>
										<Import-Package>
											sun.misc;resolution:=optional
										</Import-Package>
									</instructions>
								</artifact>

								<!-- Avoid trouble with OSGi not resolving its Import-Package to itself -->
								<artifact>
									<id>org.glassfish:javax.el:3.0.0</id>
									<source>true</source>
									<override>true</override>
									<instructions>
										<Import-Package/>
									</instructions>
								</artifact>
								<artifact>
									<id>org.glassfish.hk2:osgi-resource-locator:1.0.1</id>
									<source>true</source>
									<override>true</override>
									<instructions>
										<Import-Package>org.osgi.framework</Import-Package>
										<Export-Package>org.glassfish.hk2.osgiresourcelocator;version="1.0.1"</Export-Package>
									</instructions>
								</artifact>
								<artifact>
									<id>org.glassfish.jersey.core:jersey-common:2.27</id>
									<source>true</source>
									<override>true</override>
									<instructions>
										<Export-Package>*;version="2.27.0"</Export-Package>
										<Import-Package>
											sun.misc;resolution:=optional,
											javax.activation,
											javax.annotation;version="[1.2,2)",
											javax.imageio,
											javax.imageio.spi,
											javax.imageio.stream,
											javax.inject;version="[1.0,2)",
											javax.net.ssl,
											javax.ws.rs;version="[2.1,3)",
											javax.ws.rs.client;version="[2.1,3)",
											javax.ws.rs.container;version="[2.1,3)",
											javax.ws.rs.core;version="[2.1,3)",
											javax.ws.rs.ext;version="[2.1,3)",
											javax.xml.namespace,
											javax.xml.parsers,
											javax.xml.transform,
											javax.xml.transform.dom,
											javax.xml.transform.sax,
											javax.xml.transform.stream,
											org.glassfish.hk2.osgiresourcelocator;resolution:=optional,
											org.osgi.framework;version="[1.5,2)",
											org.w3c.dom,
											org.xml.sax
										</Import-Package>
									</instructions>
								</artifact>
							</artifacts>

							<compressSite>true</compressSite>
						</configuration>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>
</project>
